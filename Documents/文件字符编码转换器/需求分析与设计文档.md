# 文件字符编码转换器需求分析和功能设计

## 需求分析

编码问题是我们写代码经常碰到的问题，尤其是当我们的代码文件中存在中文时，统一文件编码是十分重要的。但是有的时候团队中的每个人提交的代码的编码格式都不相同，或者当自己意识到自己使用了不合适的编码的时候，已经有很多文件使用了不合适的编码。尤其是当我们不同文件使用了不同的编码时，这种情况更加糟糕，由于很多IDE（如vscode）检测编码的功能并没有为了中文特别优化，有时使用某个编码打开文件会产生乱码，所我们需要一个一个文件检查编码来排除错误。

为了解决这个问题，我们需要一个文件编码转换工具。它可以通过指定字符集（如字母、数字、符号、常用中文），当按照某一个编码规则解释时，文件中绝大部分字符都在字符集中时，才判断该文件是该编码规则进行编码的文件。在判断文件的编码的基础上，将其转换为用户指定的编码的文件。

因为当我们不希望手动转编码的时候，往往是有大量文件需要处理的情况，甚至几乎一定是有大量文件需要处理的情况，所以我们主要需要支持批量的文件转码。我们希望能够将整个项目文件夹直接打包上传，服务器进行检测和转码后，将文件夹打包返回给用户。当批量上传的时候，我们会发现不是所有文件都需要转码的，我们需要提供一定机制来帮助用户过滤不需要转换编码的文件。

## 功能设计

整个流程应该是：

1. 用户上传文件；
2. 用户指定文件过滤规则；
3. 向用户展示文件过滤结果，并进行微调；
4. 用户指定字符集；
5. 向用户展示文件的编码判断结果；
6. 用户设定目标编码格式并开始转码；
7. 下载转码后的文件；

用户上传文件可以让用户直接上传zip包。

指定过滤规则的时候，我们可以通过指定后缀的方法进行选择。另一方面，转码的往往是源代码，而源代码的范围在很多情况下其实已经通过`gitignore`文件指示出来了，所以我们可以直接通过`gitignore`来圈定范围。

向用户展示文件过滤结果后，应当提供方便的方式，让用户可以将被选中和未被选中的文件进行逐个调整。

用户指定字符集的过程中，应当提供方式可以让用户看到该字符集包含的全部字符。

展示编码判断结果的时候，后期可以添加让用户预览结果的接口，即让用户可以查看如果按照某个格式来读取这个文件，看到的内容是否是正确的。

判断编码的时候，如果不存在任何一个编码符合，就应当让用户来做决断，此时可以给出用各个编码时，文件的字符在选定的字符集中的比例，以帮助用户进行判断。




