# 登录与用户管理需求分析与功能设计

## 需求分析

~~网站设计上为工具网站，即一个应用的集合网站，每个应用间的独立性较高，作为微服务分别进行独立开发，每个应用都可能有不同的用户控制的需求，而我们希望能够统一进行管理。用户经过一次登录就可以使用所有工具，管理员可以通过一个页面来统一管理不同应用的不同用户的权限。因此，我们需要一个单点登录的授权服务器，兼顾用户的管理，作为一个独立的应用进行开发。~~

~~此时，我们需要有安全控制，一方面，授权服务器要能够鉴别应用不是伪造的，另一方面，应用服务器也要能够鉴别授权服务器不是伪造的。~~

~~单点登录后，出于用户隐私信息的考虑，应当让用户确认授权。但是每个应用都需要确认授权是十分影响体验的，所以引入白名单机制，当应用处于白名单时，可以跳过授权确认。~~

~~进一步地，我们希望有定时的权限升级，管理员应该可以方便地设置升级后的权限和持续时间，既可以直接指定用户进行升级，也可以生成激活码。~~

~~登录控制应当有基本的安全控制，如密码加密。~~

2021/8/1 把上面都删掉了。

网站设计上为小工具集合网站，目前没有盈利目标，也不涉及充值相关的内容，用户登录主要是有些工具可能需要保存状态。因此，用户登录的设计，主要应当考虑用户的便捷性。

对于大部分用户而言，他们只希望登录一次，就可以使用所有功能，而不要使用一个工具就注册一个账号。

对于一般用户，他们应当期望的是可以直接使用网站提供的功能，注册和登录是一个耽误事情和时间的过程，所以如果使用功能前需要先进行注册，就可能导致用户的流失，所以应当为他们提供不需要登录的流程。如果该服务本身就是无状态的，那么可以完全无需登录，直接使用，但是如果服务本身是有状态的，则为用户创建一个临时账号，这个账号的凭证保存在浏览器中，同时存在刷新机制，来刷新凭证的有效期、延长用户临时账号的生命周期。

对于需要跨设备使用的用户，他们对于网站一般会比较熟悉，有进一步的需求，所以他们普遍可以接受注册登录流程。但是他们很可能存在丢失密码的情况，应当有一定机制进行账号密码的找回。同时，注册用户也会希望减少重新登录的情况，尽量不要出现不注册反而比注册要方便得多的情况，让注册操作本身作为用户几乎唯一的额外操作，所以应当提供记住登录状态的功能。

对于未注册用户向注册用户迁移的过程，用户通常希望保存未注册时的状态。可以考虑直接将原先的临时账户提升至注册用户，但同时需要注意禁用原先临时账户的凭证。

## 名词解释

1. 用户：指使用本网站的自然人；
2. 账户：指服务器中保存的用户的状态信息的集合；
3. 凭证：加密的，可以验证未被篡改的一段字符串/字节序列；


## 功能设计

### 1. 临时用户注册

不需要单独的前端页面，只需要后端响应即可。当其余服务的需要临时的用户时，向用户服务发送请求，用户服务将创建一个临时账户，并返回该用户的登录凭证。该登录凭证应当有一定有效期，当超出有效期时，后端应当清理用户的信息，前端应当在用户的计算机本地保存该凭证。

### 2. 临时用户有效期刷新

不需要单独的前端页面，只需要后端响应即可。当前端检查到用户的有效期过半，前端需要通过旧凭证向后端请求新的凭证，并延长该账户的有效期。

### 3. 用户




### 流程设计

